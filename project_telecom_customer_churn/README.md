# Прогнозирование оттока клиентов оператора связи
## Описание проекта
Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

## Описание данных
Данные состоят из файлов, полученных из разных источников:

`contract.csv` — информация о договоре;

`personal.csv` — персональные данные клиента;

`internet.csv` — информация об интернет-услугах;

`phone.csv` — информация об услугах телефонии.

Во всех файлах столбец customerID содержит код клиента.

## Используемые инструменты
`CatBoost` `Sklearn` `Seaborn` `Matplotlib` `Pandas` `Numpy`

## Модели
`CatBoostClassifier` `LogisticRegression`

## Метрики
`ROC-AUC`

## Вывод

В рамках данного проекта было выполнено:
1. На первом этапе был собран датасет из 4 исходных таблиц, соединенный по customerID. После сборки образовались пропуски, так как в 2-х датасетах отсутствовали часть клинтов. Пропуски в признаках были заполнены "No", так как это означает, что клиенты не пользуются данной услугой.
2. Предобрабодка данных, были помененены типы данных у признаков BeginDate, EndDate - на datetime, а у MonthlyCharges и TotalCharges на float. Добавлен признак period, показывающий продолжительность времени использовния услуг на момент выгрузки данных. Выделен целевой признак Churn означающий факт ухода клиента (1- клиент ушел, 0 - остался).
Перед обучением были удалены признаки BeginDate и EndDate, так как вместо них был добавлен признак period. Удален gender по причине отсутствия влияния на целевой признак и удаален TotalCharges, так как имеет сильную корреляция с таргетом Churn.
После более детального рассмотрения, удалось сделать следующие выводы:
основной метод оплаты - Month-to-month используют примерно 50% пользователей, два других One yea и Two year используют примерно по 25% пользователей;
использование безбумажной оплаты более популярно;
Electronic check больше всего, Mailed check, Credit card, Bank transfer примерно одинаково;
количество женщин и мужчин приблизительно одинаково;
одинокие клиенты чаще уходят из компании;
вероятность ухода клиента меньше, если оплата помесечная;
Дальнейшем этапом работы стала подготовка данных для обучения моделей и обучение на кроссвалидации. В рамках проекта было рассмотрено 2 модели: LogisticRegression и CatBoostClassifier. Для логистической регрессии была произведена предобработка - кодирование категориальных признаков и масштабирование числовых. Обучение производилось на всех фичах, за исключением BeginDate, EndDate, TotalCharges, gender. И добавлены новые: period и целевой Churn. С помощью CatBoost этапы кодирование и масштабирования удалось избежать, используя встроенный параметр для работы с категориальными признаками, которых у нас большинство.
Итоговая модель CatBoost, показавшая луйший результат на тренировочной выборки, имеет гиперпараметры learning_rate: 0.3, iterations: 400, depth: 8 со значение ROC-AUC = 0.89. Размер тестовой выборки 0,25, значение random_state=30723.
Проект выполнен согласно плану, но в ходе его выполнения возникли трудности по достижению целевого значения 0,85 для метрики ROC-AUC. Для этого пришлось подбирать гиперпараметры и удалять/добавлять признаки.
Важными этапами при выполнения работы считаю были:
правильное соединение данных в один датафрейм;
выделение целевого признака и дополнительных признаков;
обработка пропусков;
предобработка данных перед обучения;
подбор гиперпараметров.
